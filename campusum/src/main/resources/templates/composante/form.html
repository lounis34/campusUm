<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title th:text="${isEdit} ? 'Modifier' : 'Créer'">Composante</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
    <h1 th:text="${isEdit} ? 'Modifier Composante' : 'Créer Composante'" class="mb-4"></h1>

    <form th:object="${composante}"
          th:action="@{${isEdit} ? '/composante/edit/' + ${composante.acronyme} : '/composante/create'}"
          method="post" class="needs-validation" novalidate>

        <div class="mb-3">
            <label for="acronyme" class="form-label">Acronyme<span class="text-danger">*</span>:</label>
            <input type="text" id="acronyme" th:field="*{acronyme}"
                   th:attr="readonly=${isEdit}" class="form-control" required/>
            <div class="invalid-feedback">
                Veuillez entrer l'acronyme de la composante.
            </div>
        </div>

        <div class="mb-3">
            <label for="nom" class="form-label">Nom<span class="text-danger">*</span>:</label>
            <input type="text" id="nom" th:field="*{nom}" class="form-control" required/>
            <div class="invalid-feedback">
                Veuillez entrer le nom de la composante.
            </div>
        </div>

        <div class="mb-3">
            <label for="responsable" class="form-label">Responsable<span class="text-danger">*</span>:</label>
            <input type="text" id="responsable" th:field="*{responsable}" class="form-control" required/>
            <div class="invalid-feedback">
                Veuillez entrer le responsable de la composante.
            </div>
        </div>

        <!-- Sélecteur Multi Batiments (Optionnel) -->
        <div class="mb-3" th:if="${batiments != null}">
            <label for="batiments" class="form-label">Batiments:</label>
            <select multiple id="batiments" th:field="*{batiments}" class="form-select">
                <option th:each="bat : ${batiments}"
                        th:value="${bat.codeB}"
                        th:text="${bat.codeB} + ' - ' + ${bat.campus.nomC}">
                </option>
            </select>
            <small class="form-text text-muted">Maintenez la touche Ctrl (Windows) ou Command (Mac) pour sélectionner plusieurs options.</small>
        </div>

        <div class="mb-3">
            <button type="submit" class="btn btn-success"
                    th:text="${isEdit} ? 'Modifier' : 'Créer'">Créer</button>
            <a th:href="@{/composante}" class="btn btn-secondary">Retour à la liste</a>
        </div>
    </form>
</div>

<!-- Bootstrap JS et Popper.js (pour les fonctionnalités interactives et la validation) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- Script de validation du formulaire Bootstrap -->
<script>
    // Exemple de JavaScript pour désactiver la soumission du formulaire si des champs ne sont pas valides
    (function () {
        'use strict'
        var forms = document.querySelectorAll('.needs-validation')
        Array.prototype.slice.call(forms)
            .forEach(function (form) {
                form.addEventListener('submit', function (event) {
                    if (!form.checkValidity()) {
                        event.preventDefault()
                        event.stopPropagation()
                    }
                    form.classList.add('was-validated')
                }, false)
            })
    })()
</script>
</body>
</html>